{% extends "boiler.html" %}
{%load static%}
{%load capthename%}
{%load time%}
{%block title%}Node{%endblock title%}


{%block alert%}
<div class="alert alert-danger alert-dismissible" role="alert" style="display: none;">
    <strong>Node</strong> Deleted Successfully.
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
</div>
{%endblock alert%}


<!-- **************************************************************************************************************
                                    Nav Bar Start
************************************************************************************************************** -->

{%block stats%}{%endblock stats%}                   {%block stats_link%}    inactive    {%endblock stats_link%}

{%block home%}active{%endblock home%}               {%block home_link%} active  {%endblock home_link%}

{%block events%}{%endblock events%}                 {%block events_link%}   inactive    {%endblock events_link%}

{%block config%}{%endblock config%}                 {%block config_link%}   inactive    {%endblock config_link%}

{%block blocklist%}{%endblock blocklist%}           {%block blocklist_link%}    inactive    {%endblock blocklist_link%}

{%block addhawk%}{%endblock addhawk%}               {%block addhawk_link%}  inactive    {%endblock addhawk_link%}

<!-- **************************************************************************************************************
                                        Nav Bar End
************************************************************************************************************** -->



{%block body%}
    <div class="row">
        <div class="col">
            <div id="header"
                style="background-image: linear-gradient(45deg, #ef422a, #ffffff);background-size: 100%;-webkit-background-clip: text;-moz-background-clip: text;-webkit-text-fill-color: transparent; -moz-text-fill-color: transparent;width: 200.2px;">
                <p
                    style="color: rgb(255,255,255);font-family: Poppins, sans-serif;font-size: 35px;text-align: left;font-weight: 700;margin-bottom: 0;">
                    Nodes</p>
            </div>
            <p style="color: #494d55;font-family: Poppins, sans-serif;">The Machines which are
                Active now</p>
        </div>
    </div>
    <div class="d-flex flex-row-reverse bd-highlight mb-3 row">
        <div class="dropdown">
            <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton"
                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                State of Connectivity
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <a class="dropdown-item" href="/home">All</a>
                <a class="dropdown-item" href="{%url 'home'%}?is_active=true"><span
                        style="color: green;">Online</span></a>
                <a class="dropdown-item" href="{%url 'home'%}?is_active=false"><span
                        style="color: red;">Offline</span></a>
            </div>
        </div>
    </div>
    {% if nodelist %}
    <div class="row">
        <div class="col" style="padding: 0;">
            <div style="margin-top: 15px;color: rgb(33, 37, 41);">
                <div class="col" style="padding: 0;">
                    <div class="table-responsive">
                        <table class="table">
                            <thead style="color: rgb(252, 72, 48)">
                                <tr>
                                    <th style="text-align: center;">ID</th>
                                    <th style="text-align: center;">Enrolled On</th>
                                    <!-- <th style="text-align: center;">Last seen</th> -->
                                    <th style="text-align: center;">Node Name<br></th>
                                    <th style="text-align: center;">Node-Identifier</th>
                                    <th style="text-align: center;">Os-Arch<br></th>
                                    <th style="text-align: center;">Os-Name<br></th>
                                    <th style="text-align: center;">Severity<br></th>
                                </tr>
                            </thead>
                            <tbody style="color: rgb(255,255,255);">
                                {%for i in nodelist%}
                                <tr>
                                    <td style="text-align: center;">{{forloop.counter}}</td>
                                    <td style="text-align: center;">{{i.enrolled_on | print_timestamp}}</td>
                                    {%comment%}<td style="text-align: center;">{%if i.last_seen%}{{ i.last_seen | to_dict | display | sectohr }}{%endif%}</td>{%endcomment%}
                                    <td style="text-align: center;">{{i.hostname}}</td>
                                    <td style="text-align: center;">
                                        <div class="row">
                                            <div class="col-xl-4" style="text-align: end;">
                                                {% if i.last_seen.3 == "n" %}
                                                <img src="{% static 'assets/img/green_dot.jpg'%}"
                                                    style="height: 12px;border-radius: 50px;width: 12px;margin-right: 15px;">
                                                {% elif i.last_seen.3 == "f" %}
                                                <img src="{% static 'assets/img/red_dot.jpg'%}"
                                                    style="height: 12px;border-radius: 50px;width: 12px;margin-right: 15px;">
                                                {%endif%}
                                            </div>
                                            <div class="col-xl-8" style="padding: 0;display: flex;">
                                                <a style="text-decoration: none;"
                                                    href="{%url 'info'%}?host_id={{i.host_identifier}}">{{i.host_identifier}}</a>
                                            </div>
                                        </div>
                                    </td>
                                    <td style="text-align: center;">{{i.os_arch}}</td>
                                    <td style="text-align: center;">{{i.os_name}}</td>
                                    <td style="text-align: center;">
                                        <div>
                                            <div class="progress">
                                                <div class="progress-bar" role="progressbar" style="width: {{forloop.counter}}0%;
                                                                                            background-color:
                                                                                            {%if forloop.counter == 1 %}
                                                                                            #36CCFC
                                                                                            {%elif forloop.counter == 2 %}
                                                                                            #5DEE3B
                                                                                            {%elif forloop.counter == 3 %}
                                                                                            #FCE552
                                                                                            {%elif forloop.counter == 4 %}
                                                                                            #FEB032
                                                                                            {%elif forloop.counter == 5 %}
                                                                                            #FD393F
                                                                                            {%else%}
                                                                                            #00FFFF
                                                                                            {% endif %}"
                                                    aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                {%endfor%}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {%else%}
    <div id="truck">

        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
            x="0px" y="0px" viewBox="0 0 200 82.7" style="enable-background:new 0 0 200 82.7;"
            xml:space="preserve">

            <g id="Calque_1">
                <text id="XMLID_3_" transform="matrix(1.2187 0 0 1 13 75.6393)" class="st0 st1">4</text>
                <text id="XMLID_4_" transform="matrix(1.2187 0 0 1 133.0003 73.6393)"
                    class="st0 st1">4</text>
            </g>
            <g id="Calque_2">
                <g>
                    <path id="XMLID_11_" d="M81.8,29.2c4.1-5.7,10.7-9.4,18.3-9.4c6.3,0,12.1,2.7,16.1,6.9c0.6-0.4,1.1-0.7,1.7-1.1
            c-4.4-4.8-10.8-7.9-17.8-7.9c-8.3,0-15.6,4.2-20,10.6C80.7,28.5,81.3,28.8,81.8,29.2z" />
                    <path id="XMLID_2_" d="M118.1,53.7c-4,5.7-10.7,9.5-18.2,9.5c-6.3,0-12.1-2.6-16.2-6.8c-0.6,0.4-1.1,0.7-1.7,1.1
            c4.4,4.8,10.8,7.8,17.9,7.8c8.3,0,15.6-4.3,19.9-10.7C119.2,54.5,118.6,54.1,118.1,53.7z" />
                    <animateTransform attributeName="transform" type="rotate" from="360 100 41.3"
                        to="0 100 41.3" dur="10s" repeatCount="indefinite" />
                </g>
                <g id="XMLID_6_">
                    <g id="XMLID_18_">



                        <circle class="circle" cx="100" cy="41" r="1"></circle>
                    </g>
                </g>
                <defs>
                    <filter id="blurFilter4" x="-20" y="-20" width="200" height="200">
                        <feGaussianBlur in="SourceGraphic" stdDeviation="2" />
                    </filter>
                </defs>
                <path id="XMLID_5_" class="st2" d="M103.8,16.7c0.1,0.3,0.1,0.6,0.1,0.9c11.6,1.9,20.4,11.9,20.4,24.1c0,13.5-10.9,24.4-24.4,24.4
      S75.6,55.1,75.6,41.7c0-3.2,0.6-6.3,1.7-9.1c-0.3-0.2-0.5-0.3-0.7-0.5c-1.2,3-1.9,6.2-1.9,9.6c0,14,11.3,25.3,25.3,25.3
      s25.3-11.3,25.3-25.3C125.3,29,115.9,18.5,103.8,16.7z" />


            </g>
        </svg>

        <div class="message">
            {{message}}
        </div>
    </div>
    {%endif%}
</div>
</div>
{%endblock body%}


{%block script%}
<script>
    if (localStorage.getItem("delete") == 1) {
        $('.alert').css("display", "inherit");
        $('.alert').alert();
        setTimeout(function () { $(".alert").alert('close') }, 3000);
        localStorage.setItem("delete", 0);
    }
</script>
<script>
    $(document).ready(function () {
        $('[data-toggle="tooltip"]').tooltip();
    });
</script>
{%endblock script%}